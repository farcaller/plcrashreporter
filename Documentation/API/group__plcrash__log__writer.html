<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>PlausibleCrashReporter: Crash Log Writer</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Crash Log Writer<br>
<small>
[<a class="el" href="group__plcrash__internal.html">Crash Reporter Internal Documentation</a>]</small>
</h1>Implements an async-safe, zero allocation crash log writer C API, intended to be called from the crash log signal handler.  
<a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
Collaboration diagram for Crash Log Writer:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__plcrash__log__writer.png" border="0" alt="" usemap="#group____plcrash____log____writer_map">
<map name="group____plcrash____log____writer_map">
<area shape="rect" id="node2" href="group__plcrash__internal.html" title="Crash Reporter Internal Documentation" alt="" coords="5,5,296,35"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>plcrash_log_writer</b></td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gad573fb0d6eb71d878d6a74ca92764a2"></a><!-- doxytag: member="plcrash_log_writer::plcrash_log_writer_t" ref="gad573fb0d6eb71d878d6a74ca92764a2" args="" -->
typedef struct plcrash_log_writer&nbsp;</td><td class="memItemRight" valign="bottom"><b>plcrash_log_writer_t</b></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">plcrash_error_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__plcrash__log__writer.html#g8709ae6f2b298d25b00d760559b1edc8">plcrash_log_writer_init</a> (plcrash_log_writer_t *writer, NSString *app_identifier, NSString *app_version)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a new crash log writer instance.  <a href="#g8709ae6f2b298d25b00d760559b1edc8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__plcrash__log__writer.html#gc80abcafc109ea926097a0cb0ee870b6">plcrash_log_writer_set_exception</a> (plcrash_log_writer_t *writer, NSException *exception)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the uncaught exception for this writer.  <a href="#gc80abcafc109ea926097a0cb0ee870b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">plcrash_error_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__plcrash__log__writer.html#g7715b2f68617b2d3d595205e62b932fd">plcrash_log_writer_write</a> (plcrash_log_writer_t *writer, plcrash_async_file_t *file, siginfo_t *siginfo, ucontext_t *crashctx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the crash report.  <a href="#g7715b2f68617b2d3d595205e62b932fd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">plcrash_error_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__plcrash__log__writer.html#ge3ef6acd5b45baf6dd6b84a1eb8e04bc">plcrash_log_writer_close</a> (plcrash_log_writer_t *writer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close the plcrash_writer_t output.  <a href="#ge3ef6acd5b45baf6dd6b84a1eb8e04bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__plcrash__log__writer.html#gaf768afab874fdff860485e84781efba">plcrash_log_writer_free</a> (plcrash_log_writer_t *writer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free any crash log writer resources.  <a href="#gaf768afab874fdff860485e84781efba"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implements an async-safe, zero allocation crash log writer C API, intended to be called from the crash log signal handler. <hr><h2>Function Documentation</h2>
<a class="anchor" name="ge3ef6acd5b45baf6dd6b84a1eb8e04bc"></a><!-- doxytag: member="PLCrashLogWriter.h::plcrash_log_writer_close" ref="ge3ef6acd5b45baf6dd6b84a1eb8e04bc" args="(plcrash_log_writer_t *writer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plcrash_error_t plcrash_log_writer_close           </td>
          <td>(</td>
          <td class="paramtype">plcrash_log_writer_t *&nbsp;</td>
          <td class="paramname"> <em>writer</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close the plcrash_writer_t output. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>writer</em>&nbsp;</td><td>Writer instance to be closed. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="gaf768afab874fdff860485e84781efba"></a><!-- doxytag: member="PLCrashLogWriter.h::plcrash_log_writer_free" ref="gaf768afab874fdff860485e84781efba" args="(plcrash_log_writer_t *writer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plcrash_log_writer_free           </td>
          <td>(</td>
          <td class="paramtype">plcrash_log_writer_t *&nbsp;</td>
          <td class="paramname"> <em>writer</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free any crash log writer resources. 
<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>This method is not async safe. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g8709ae6f2b298d25b00d760559b1edc8"></a><!-- doxytag: member="PLCrashLogWriter.h::plcrash_log_writer_init" ref="g8709ae6f2b298d25b00d760559b1edc8" args="(plcrash_log_writer_t *writer, NSString *app_identifier, NSString *app_version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plcrash_error_t plcrash_log_writer_init           </td>
          <td>(</td>
          <td class="paramtype">plcrash_log_writer_t *&nbsp;</td>
          <td class="paramname"> <em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NSString *&nbsp;</td>
          <td class="paramname"> <em>app_identifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NSString *&nbsp;</td>
          <td class="paramname"> <em>app_version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize a new crash log writer instance. 
<p>
This fetches all necessary environment information.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>writer</em>&nbsp;</td><td>Writer instance to be initialized. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app_identifier</em>&nbsp;</td><td>Unique per-application identifier. On Mac OS X, this is likely the CFBundleIdentifier. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app_version</em>&nbsp;</td><td>Application version string.</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>If this function fails, <a class="el" href="group__plcrash__log__writer.html#gaf768afab874fdff860485e84781efba" title="Free any crash log writer resources.">plcrash_log_writer_free()</a> should be called to free any partially allocated data.</dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>This function is not guaranteed to be async-safe, and must be called prior to entering the crash handler. </dd></dl>

</div>
</div><p>
<a class="anchor" name="gc80abcafc109ea926097a0cb0ee870b6"></a><!-- doxytag: member="PLCrashLogWriter.h::plcrash_log_writer_set_exception" ref="gc80abcafc109ea926097a0cb0ee870b6" args="(plcrash_log_writer_t *writer, NSException *exception)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plcrash_log_writer_set_exception           </td>
          <td>(</td>
          <td class="paramtype">plcrash_log_writer_t *&nbsp;</td>
          <td class="paramname"> <em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NSException *&nbsp;</td>
          <td class="paramname"> <em>exception</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the uncaught exception for this writer. 
<p>
Once set, this exception will be used to provide exception data for the crash log output.<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>This function is not async safe, and must be called outside of a signal handler. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g7715b2f68617b2d3d595205e62b932fd"></a><!-- doxytag: member="PLCrashLogWriter.h::plcrash_log_writer_write" ref="g7715b2f68617b2d3d595205e62b932fd" args="(plcrash_log_writer_t *writer, plcrash_async_file_t *file, siginfo_t *siginfo, ucontext_t *crashctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plcrash_error_t plcrash_log_writer_write           </td>
          <td>(</td>
          <td class="paramtype">plcrash_log_writer_t *&nbsp;</td>
          <td class="paramname"> <em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">plcrash_async_file_t *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">siginfo_t *&nbsp;</td>
          <td class="paramname"> <em>siginfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ucontext_t *&nbsp;</td>
          <td class="paramname"> <em>crashctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the crash report. 
<p>
All other running threads are suspended while the crash report is generated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>writer</em>&nbsp;</td><td>The writer context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>The output file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>siginfo</em>&nbsp;</td><td>Signal information </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>crashctx</em>&nbsp;</td><td>Context of the crashed thread.</td></tr>
  </table>
</dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>This method must only be called from the thread that has triggered the crash. This must correspond to the provided crashctx. Failure to adhere to this requirement will result in an invalid stack trace and thread dump. </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Sep 5 15:33:47 2009 for PlausibleCrashReporter by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
